<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gas consumption • DiveR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Gas consumption">
<meta property="og:description" content="DiveR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DiveR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/gas_conso.html">Gas consumption</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="gas_conso_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Gas consumption</h1>
                        <h4 class="author">Maxime Jaunatre</h4>
            
            <h4 class="date">2021-03-07</h4>
      
      
      <div class="hidden name"><code>gas_conso.Rmd</code></div>

    </div>

    
    
<style>
body {
text-align: justify}
</style>
<p>The package <code>{DiveR}</code> provide functions to simulate gas consumption. It does so by using tank object and putting them in link with a dive curve and few parameters. This vignette will demonstrate the workflow to use tanks, for a dive with a single tank to using multiples ones on different setups.</p>
<div id="tank-creation" class="section level2">
<h2 class="hasAnchor">
<a href="#tank-creation" class="anchor"></a>Tank creation</h2>
<p>A tank can basically be set by 2 important parameters : a volume <code>vol</code> and a pressure <code>press</code>. Other input are used to set rules to define when and where the tank can be used to breath.</p>
<p>Volume is set in litre and pressure in bar.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">DiveR</span><span class="op">)</span>
<span class="va">tank1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tank.html">tank</a></span><span class="op">(</span>vol <span class="op">=</span> <span class="fl">12</span>, press <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>
<span class="va">tank1</span>
<span class="co">#&gt; $carac</span>
<span class="co">#&gt;   vol press rule1 rule2 </span>
<span class="co">#&gt;    12   200   100    50 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $typo</span>
<span class="co">#&gt;      gas      typ    rule1    rule2     name </span>
<span class="co">#&gt;    "Air"   "back"    "mid"    "res" "back12" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $limit</span>
<span class="co">#&gt; mind maxd   t1   t2 </span>
<span class="co">#&gt;    0   66   NA   NA </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "tank"</span></code></pre></div>
<p>We can see that many values are set by default, the principal one being the gas type. At this time only air is used and thus tanks are limited between the surface (0) and 66m of depth.</p>
<p>Default rules are also set, which will message the user when the tank is half empty, 3/4 empty and when there is no gas left in it. You can set them like below, and name the rules too.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set in percentage</span>
<span class="va">tank2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tank.html">tank</a></span><span class="op">(</span>vol <span class="op">=</span> <span class="fl">12</span>, press <span class="op">=</span> <span class="fl">200</span>, 
              rules <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>rules <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'mid'</span> <span class="op">=</span> <span class="fl">50</span>, <span class="st">'quarter'</span> <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>, sys <span class="op">=</span> <span class="st">'%'</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/rules.html">rules</a></span><span class="op">(</span><span class="va">tank2</span><span class="op">)</span>
<span class="co">#&gt;     mid quarter </span>
<span class="co">#&gt;     100      50</span>
<span class="co"># set in bar</span>
<span class="va">tank3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tank.html">tank</a></span><span class="op">(</span>vol <span class="op">=</span> <span class="fl">12</span>, press <span class="op">=</span> <span class="fl">200</span>, 
              rules <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>rules <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'return'</span> <span class="op">=</span> <span class="fl">130</span>, <span class="st">'end'</span> <span class="op">=</span> <span class="fl">80</span><span class="op">)</span>, sys <span class="op">=</span> <span class="st">'bar'</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/rules.html">rules</a></span><span class="op">(</span><span class="va">tank3</span><span class="op">)</span>
<span class="co">#&gt; return    end </span>
<span class="co">#&gt;    130     80</span></code></pre></div>
<div id="tank-types" class="section level3">
<h3 class="hasAnchor">
<a href="#tank-types" class="anchor"></a>Tank types</h3>
<p>By default, the tank type is set to <em>back</em>, a category to describe back-mounted tanks commonly used by divers. However it is possible to have tanks dedicated to specific usage in a relay or at the end of a dive.</p>
<div id="relay-tank" class="section level4">
<h4 class="hasAnchor">
<a href="#relay-tank" class="anchor"></a>Relay tank</h4>
<p>A tank used at the beginning and the end of a dive. Mostly used in cave diving. This type is attributed to tanks where there is an interdiction of usage between 2 times.</p>
<p>The easier way to input this interdiction is to set the two rules at same value. During the dive, the tank will be used until pressure match 120b. Then the diver will use other tanks up to their second rules (ex : back tank reserve at 50b). When done, the diver will get back to the relay tank to finish the dive with it.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">relay</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tank.html">tank</a></span><span class="op">(</span>vol <span class="op">=</span> <span class="fl">12</span>, press <span class="op">=</span> <span class="fl">180</span>, typ <span class="op">=</span> <span class="st">'relay'</span>,
              rules <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>rules <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'gap'</span> <span class="op">=</span> <span class="fl">120</span>, <span class="st">'end_gap'</span> <span class="op">=</span> <span class="fl">120</span><span class="op">)</span>, sys <span class="op">=</span> <span class="st">'bar'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<!--
#### Desaturation tank

**Other gas than Air are not yet included but the consumption algorithm is set for them**

A tank used at the end of a dive to desaturate azote during ascent part of the dive. Often limited to a lower depth because it use other gas than air. This type of tank are tanks that divers can't use until he has used other tanks or passed the dive end point.

You can add an interdiction of using a tank by setting the first rule with the same value as the tank pressure.


```r
desat <- tank(vol = 12, press = 180, typ = 'relay',
              rules = list(rules = c('gap' = 100, 'end_gap' = 25), sys = '%'))
desat$carac[c('rule1', 'rule2')]
#> rule1 rule2 
#>   180    45
```

-->
<p>As these tanks are used in combination with a back-mounted tank, their usage will be described in the multiple tank usage part. The algorithm of usage will be described, don’t fear not understanding it right now.</p>
</div>
</div>
</div>
<div id="tank-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#tank-methods" class="anchor"></a>Tank methods</h2>
<p>The parameters of a tank can be retrieved with specified function. We can find the volume, pressure and rules of any tank. All these informations are grouped in a summary function</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pressure.html">pressure</a></span><span class="op">(</span><span class="va">relay</span><span class="op">)</span>
<span class="co">#&gt; [1] 180</span>
<span class="fu"><a href="../reference/volume.html">volume</a></span><span class="op">(</span><span class="va">relay</span><span class="op">)</span>
<span class="co">#&gt; [1] 12</span>
<span class="fu"><a href="../reference/rules.html">rules</a></span><span class="op">(</span><span class="va">relay</span><span class="op">)</span>
<span class="co">#&gt;     gap end_gap </span>
<span class="co">#&gt;     120     120</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">relay</span><span class="op">)</span>
<span class="co">#&gt; Tank : 12 litre at 180 bar</span>
<span class="co">#&gt; rules : 1 gap : 120 bar</span>
<span class="co">#&gt;         2 end_gap : 120 bar</span>
<span class="co">#&gt; The tank type is relay and contain Air </span>
<span class="co">#&gt; Named : relay12</span></code></pre></div>
</div>
<div id="tank-consumption" class="section level2">
<h2 class="hasAnchor">
<a href="#tank-consumption" class="anchor"></a>Tank consumption</h2>
<p>Once the tanks are defined, you can combine them with a dive. The <code>conso</code> function will then compute how many gas the diver will consume by following the dive depth curve and report pressure at different times of the dive. The function will also catch times where the rules of a tank are met. Note here that a new rules about air failure is added to each tank to report when a tank is empty.</p>
<p>If no tanks are available (pressure &gt; 0) at some time, the function will return warnings to highlight these times.</p>
<p>For the following examples, we will use a single dive of 40 minutes at 20 meter. There is one desaturation stop for 3min at 3m.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simp_dive</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dive.html">dive</a></span><span class="op">(</span>depth <span class="op">=</span> <span class="fl">20</span>, time <span class="op">=</span> <span class="fl">40</span>, secu <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">simp_dive</span><span class="op">)</span>
<span class="co">#&gt; Dive for : 40 minutes at 20 meters</span>
<span class="co">#&gt; Total dive time is 45.2 with a dive ascent of 5.2 minutes</span>
<span class="co">#&gt; 1 stops :   3 minutes at 3 meters </span>
<span class="co">#&gt; The dive group is H</span></code></pre></div>
<p>For multiple dives you need to choose one of the two dives. A special case for consecutive dives is at work.</p>
<div id="single-tank" class="section level3">
<h3 class="hasAnchor">
<a href="#single-tank" class="anchor"></a>Single Tank</h3>
<p>First we try to use a tank with a volume of 12L at 200 bar. The diver will breathe 20L/min, which is the default value of the function.</p>
<p>A rapid observation of the consumption if possible by plotting the consumption object. We can easily see when the pressure met the rules and when the diver died (40min). This was also printed in warnings with specified times with missing gas.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Tank_12L</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tank.html">tank</a></span><span class="op">(</span>vol <span class="op">=</span> <span class="fl">12</span>, press <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>
<span class="va">death</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conso.html">conso</a></span><span class="op">(</span>dive <span class="op">=</span> <span class="va">simp_dive</span>, tank <span class="op">=</span> <span class="va">Tank_12L</span>, 
               cons <span class="op">=</span> <span class="fl">20</span>, failure_label <span class="op">=</span> <span class="st">'Air failure'</span><span class="op">)</span>
<span class="co">#&gt; Warning in conso(dive = simp_dive, tank = Tank_12L, cons = 20, failure_label =</span>
<span class="co">#&gt; "Air failure"): No tank is available between 40 and 41.7 minutes so you died.</span>
<span class="co">#&gt; Try again !</span>
<span class="co">#&gt; Warning in conso(dive = simp_dive, tank = Tank_12L, cons = 20, failure_label =</span>
<span class="co">#&gt; "Air failure"): No tank is available between 41.7 and 44.7 minutes so you died.</span>
<span class="co">#&gt; Try again !</span>
<span class="co">#&gt; Warning in conso(dive = simp_dive, tank = Tank_12L, cons = 20, failure_label =</span>
<span class="co">#&gt; "Air failure"): No tank is available between 44.7 and 45.2 minutes so you died.</span>
<span class="co">#&gt; Try again !</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">death</span>, line_print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="gas_conso_files/figure-html/death_conso-1.png" width="100%"></p>
<p>Once we observed this, we can solve the issue by using a different tank for example. Here we will increase the volume to 15L to get more air during the dive. Note that we could also increase the pressure of the precedent tank. Another solution could be to breath less and using a diver using <code>cons = 15</code>.</p>
<p>This solution work and the diver get to the end of the dive alive ! Hourra !</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Tank_15L</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tank.html">tank</a></span><span class="op">(</span>vol <span class="op">=</span> <span class="fl">15</span>, press <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>
<span class="va">viable</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conso.html">conso</a></span><span class="op">(</span>dive <span class="op">=</span> <span class="va">simp_dive</span>, tank <span class="op">=</span> <span class="va">Tank_15L</span>, 
               cons <span class="op">=</span> <span class="fl">20</span>, failure_label <span class="op">=</span> <span class="st">'Air failure'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">viable</span>, line_print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="gas_conso_files/figure-html/viable_conso-1.png" width="100%"></p>
</div>
</div>
<div id="consumption-attributes" class="section level2">
<h2 class="hasAnchor">
<a href="#consumption-attributes" class="anchor"></a>Consumption attributes</h2>
<p>Now that we have simulated both consumption on the same dive, we may want to find more information about the simulations, which will help us dive safely.</p>
<p>First we can check the pressure at the end of the dive. This can be helpful to see if the diver can still be alive. Here we see that effectively in the death simulation, the tank was empty at the end of the dive.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pressure.html">pressure</a></span><span class="op">(</span><span class="va">death</span><span class="op">)</span>
<span class="co">#&gt; back12 </span>
<span class="co">#&gt;      0</span></code></pre></div>
<p>However this does not tell us when this happened. To find out when, we can check when the rules have been met with the <code>rules</code> function. This will help us check the dive instructor interdiction to use the reserve of the tank (here 50bar) in both simulations.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rules.html">rules</a></span><span class="op">(</span><span class="va">death</span><span class="op">)</span>
<span class="co">#&gt;        rule1 name1 time1 rule2 name2 time2 empty       nameE timeE</span>
<span class="co">#&gt; back12   100   mid    20    50   res    30     0 Air failure    40</span>
<span class="fu"><a href="../reference/rules.html">rules</a></span><span class="op">(</span><span class="va">viable</span><span class="op">)</span>
<span class="co">#&gt;        rule1 name1 time1 rule2 name2 time2 empty       nameE timeE</span>
<span class="co">#&gt; back15   100   mid    25    50   res  37.5     0 Air failure    NA</span></code></pre></div>
<p>So, here, despite the diver in <code>viable</code> make it alive to the end of the dive, he didn’t respect the second rule of ending the dive with 50 bar at the end.</p>
<p>Finally we can find all information in a summary.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">death</span><span class="op">)</span>
<span class="co">#&gt; Consumption simulated on dive at 20 m for 45.2 minutes</span>
<span class="co">#&gt; ---------------------------------------------------------------------</span>
<span class="co">#&gt;        Tank name |         Rule | Pressure |    Time | Final pressure </span>
<span class="co">#&gt; ---------------------------------------------------------------------</span>
<span class="co">#&gt;      Tank back12 |          mid |  100 bar |  20 min | 0 bar</span>
<span class="co">#&gt;                  |          res |   50 bar |  30 min |    </span>
<span class="co">#&gt;                  |  Air failure |    0 bar |  40 min |     </span>
<span class="co">#&gt; ---------------------------------------------------------------------</span>
<span class="co">#&gt; The dive is deadly !</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">viable</span><span class="op">)</span>
<span class="co">#&gt; Consumption simulated on dive at 20 m for 45.2 minutes</span>
<span class="co">#&gt; ---------------------------------------------------------------------</span>
<span class="co">#&gt;        Tank name |         Rule | Pressure |    Time | Final pressure </span>
<span class="co">#&gt; ---------------------------------------------------------------------</span>
<span class="co">#&gt;      Tank back15 |          mid |  100 bar |  25 min | 29.16 bar</span>
<span class="co">#&gt;                  |          res |   50 bar |  38 min |    </span>
<span class="co">#&gt;                  |  Air failure |    0 bar |  NA min |     </span>
<span class="co">#&gt; ---------------------------------------------------------------------</span>
<span class="co">#&gt; The dive is viable !</span></code></pre></div>
</div>
<div id="multiple-tank" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-tank" class="anchor"></a>Multiple Tank</h2>
<p>To respect all rules broken before in this vignette we could use even larger tank or dive a shorter time. An other option could be to use multiple tanks.</p>
<p>This is done by simply giving a list of tanks to the <code>conso</code> function.</p>
<p>Below is an example of 2 independant 10L tanks used by the function. <strong>For better understanding, it is better name them.</strong></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A_10L</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tank.html">tank</a></span><span class="op">(</span>vol <span class="op">=</span> <span class="fl">10</span>, press <span class="op">=</span> <span class="fl">200</span>, name <span class="op">=</span> <span class="st">'A_10L'</span><span class="op">)</span>
<span class="va">B_10L</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tank.html">tank</a></span><span class="op">(</span>vol <span class="op">=</span> <span class="fl">10</span>, press <span class="op">=</span> <span class="fl">200</span>, name <span class="op">=</span> <span class="st">'B_10L'</span><span class="op">)</span>
<span class="va">bi_conso</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conso.html">conso</a></span><span class="op">(</span>dive <span class="op">=</span> <span class="va">simp_dive</span>, tank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">A_10L</span>, <span class="va">B_10L</span><span class="op">)</span>, 
               cons <span class="op">=</span> <span class="fl">20</span>, failure_label <span class="op">=</span> <span class="st">'Air failure'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">bi_conso</span>, line_print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="gas_conso_files/figure-html/mult_tank-1.png" width="100%"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pressure.html">pressure</a></span><span class="op">(</span><span class="va">bi_conso</span><span class="op">)</span>
<span class="co">#&gt; A_10L B_10L </span>
<span class="co">#&gt; 50.00 93.74</span></code></pre></div>
<p>We managed to get to the end of the dive alive and with no tank below 50 bar !</p>
<p>The plot make it look messy but illustrate the algorithm written to used multiple tanks.</p>
<ol style="list-style-type: decimal">
<li><p>The tanks are used by their order in the list provided.</p></li>
<li><p>The tanks are used until they reach a rules. At this rule, the diver will switch to the next tank available before it’s first rule.</p></li>
<li><p>It check tank availability at each time (not showed in this example).</p></li>
</ol>
<p>By using these simple rules, you can set diverse multiple tanks configurations.</p>
<div id="one-relay-and-back-tank" class="section level4">
<h4 class="hasAnchor">
<a href="#one-relay-and-back-tank" class="anchor"></a>One relay and back tank</h4>
<p>We want to design a dive where we start on a relay tank (named Relay) up to a third of the pressure, then consume our back tank (named Tank_10L). Once the latter cross the second rule (or reserve), we finish the dive with the Relay.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Relay</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tank.html">tank</a></span><span class="op">(</span>vol <span class="op">=</span> <span class="fl">10</span>, press <span class="op">=</span> <span class="fl">200</span>, typ <span class="op">=</span> <span class="st">'relay'</span>, rules <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  rules <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">' '</span> <span class="op">=</span> <span class="fl">66</span>, <span class="st">'drop relay'</span> <span class="op">=</span> <span class="fl">66</span><span class="op">)</span>,
  sys <span class="op">=</span> <span class="st">'%'</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Relay"</span>
  <span class="op">)</span>

<span class="va">Tank_10L</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tank.html">tank</a></span><span class="op">(</span>vol <span class="op">=</span> <span class="fl">10</span>, press <span class="op">=</span> <span class="fl">200</span>, rules <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  rules <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Return'</span> <span class="op">=</span> <span class="fl">100</span>, <span class="st">"Reserve"</span> <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>, 
  sys <span class="op">=</span> <span class="st">"bar"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Back"</span>
  <span class="op">)</span>

<span class="va">relay_conso</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conso.html">conso</a></span><span class="op">(</span>dive <span class="op">=</span> <span class="va">simp_dive</span>, 
                     tank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">Relay</span>, <span class="va">Tank_10L</span><span class="op">)</span>, 
                     cons <span class="op">=</span> <span class="fl">20</span>, failure_label <span class="op">=</span> <span class="st">'Air failure'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">relay_conso</span>, line_print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="gas_conso_files/figure-html/mult_relay-1.png" width="100%"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">relay_conso</span><span class="op">)</span>
<span class="co">#&gt; Consumption simulated on dive at 20 m for 45.2 minutes</span>
<span class="co">#&gt; ---------------------------------------------------------------------</span>
<span class="co">#&gt;        Tank name |         Rule | Pressure |    Time | Final pressure </span>
<span class="co">#&gt; ---------------------------------------------------------------------</span>
<span class="co">#&gt;       Tank Relay |              |  132 bar |  11 min | 93.74 bar</span>
<span class="co">#&gt;                  |   drop relay |  132 bar |  11 min |    </span>
<span class="co">#&gt;                  |  Air failure |    0 bar |  NA min |     </span>
<span class="co">#&gt; ---------------------------------------------------------------------</span>
<span class="co">#&gt;        Tank Back |       Return |  100 bar |  28 min | 50 bar</span>
<span class="co">#&gt;                  |      Reserve |   50 bar |  36 min |    </span>
<span class="co">#&gt;                  |  Air failure |    0 bar |  NA min |     </span>
<span class="co">#&gt; ---------------------------------------------------------------------</span>
<span class="co">#&gt; The dive is viable !</span></code></pre></div>
<p>With this configuration we still have our reserve on our back tank, and lot of gas in our relay. Note that because the relay is still available between it’s drop and the back tank reserve, a full line is drawn</p>
<!--
#### Multiple relay and back tank

A second configuration could be to use multiple relay



-->
<!--
#### One Deco and back tank

We want to design a dive where we dive with our back tank (named Tank_15L). Once the latter cross the second rule (or reserve), we finish the dive with a tank waiting for us. This is to mimic a desaturation tank despite other gas than air are not yet implemented




-->
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Maxime Jaunatre.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
